<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="top.zzh.dao.TzbDAO">

    <insert id="save" parameterType="top.zzh.bean.Tzb">
        <![CDATA[
          insert into t_tzb(uid,juid,money,time,nprofit,cpname,baid)
          values(#{uid},#{juid},#{money},#{time},#{nprofit},#{cpname},#{baid})
        ]]>
    </insert>

    <!-- 投资金额，投资产品，投资时间-->
    <sql id="cash_query_criteria">
        <if test="query != null and query.money != null">
            and t.money like concat('%', #{query.money}, '%')
        </if>
        <if test="query != null and query.cpname != null">
            and t.cpname like concat('%', #{query.cpname}, '%')
        </if>
        <if test="query != null and query.time != null">
            and t.time like concat('%', #{query.time}, '%')
        </if>
    </sql>

    <select id="listPager" resultType="top.zzh.bean.Tzb">
        <![CDATA[
            select u.uname,b.baid,t.money,t.time,t.cpname,t.nprofit from t_tzb t,t_user u,t_borrowapply b
             where t.uid = u.uid and b.baid = t.baid
             limit #{pager.beginIndex}, #{pager.pageSize}
        ]]>
    </select>

    <select id="listPagerCriteria" resultType="top.zzh.bean.Tzb">
         select u.uname,b.baid,t.money,t.time,t.cpname,t.nprofit from t_tzb t,t_user u,t_borrowapply b
          where t.uid = u.uid and b.baid = t.baid
        <include refid="cash_query_criteria"/>
          limit #{pager.beginIndex}, #{pager.pageSize}
    </select>

    <select id="countCriteria" resultType="long">
        <![CDATA[
            select count(tzid) from t_tzb t,t_user u,t_borrowapply b
          where t.uid = u.uid and b.baid = t.baid
        ]]>
    </select>

    <select id="count" resultType="top.zzh.bean.Tzb">
        <![CDATA[
          select count(tzid) from t_tzb
        ]]>
    </select>
</mapper>